<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Wheel RPG</title>

<style>
body{
font-family:Arial;
background:black;
color:white;
text-align:center;
}

.wheel{
width:220px;
height:220px;
margin:auto;
border-radius:50%;
border:6px solid cyan;
transition: transform 4s ease-out;
position:relative;
}

.sliceLabel{
position:absolute;
width:100%;
top:50%;
left:0;
transform-origin:center left;
font-size:14px;
}

.panel{
background:#111;
margin:20px auto;
padding:20px;
border-radius:15px;
max-width:600px;
}

button{
padding:12px 20px;
margin:8px;
border:none;
border-radius:10px;
font-size:16px;
}
</style>
</head>

<body>

<h1>ðŸŽ® Wheel RPG ðŸŽ¡</h1>

<div class="panel">
<input id="playerName" placeholder="Character Name">
<button onclick="spin()">Spin (1 per day)</button>
</div>

<div class="panel">
<div class="wheel" id="wheel"></div>
<div id="result">Spin to generate</div>
<img id="portrait" width="180">
</div>

<div class="panel">
<h3>PvE Battle</h3>
<button onclick="fightAI()">Fight Enemy</button>
<div id="battleLog"></div>
</div>

<div class="panel">
<h3>Admin Dashboard</h3>
<input id="adminPass" placeholder="Password">
<button onclick="showAdmin()">Open Admin</button>
<div id="adminArea"></div>
</div>

<script>

// ===== SETTINGS =====
const ADMIN = "226wheel";

// ===== BAD WORD FILTER =====
const badWords = ["badword1","badword2","badword3"];

// ===== TRAITS WITH % RARITY =====
let species = [
{name:"Human", chance:40, img:"https://i.imgur.com/9QZ7Q9K.png"},
{name:"Elf", chance:25, img:"https://i.imgur.com/1X6G7YB.png"},
{name:"Robot", chance:20, img:"https://i.imgur.com/0Z8FQZR.png"},
{name:"Celestial", chance:10, img:"https://i.imgur.com/FpQXG2S.png"},
{name:"Void Titan", chance:5, img:"https://i.imgur.com/tV6KQbG.png"}
];

// ===== UNLOCK SYSTEM =====
let unlocked = JSON.parse(localStorage.getItem("unlocked")||"[]");

// ===== DAILY SPIN CHECK =====
function canSpin(){

let last = localStorage.getItem("lastSpin");
if(!last) return true;

let now = Date.now();
return now - last > 86400000; // 24 hours
}

// ===== NAME FILTER =====
function validName(name){

name = name.toLowerCase();
for(let w of badWords){
if(name.includes(w)) return false;
}
return true;
}

// ===== % RANDOM PICK =====
function weightedPick(list){

let total = list.reduce((a,b)=>a+b.chance,0);
let roll = Math.random()*total;

let sum = 0;
for(let item of list){
sum += item.chance;
if(roll <= sum) return item;
}
}

// ===== WHEEL DRAW =====
function drawWheel(){

wheel.innerHTML="";

let total = species.length;
let degPer = 360/total;

species.forEach((s,i)=>{

let label = document.createElement("div");
label.className="sliceLabel";
label.style.transform=
"rotate("+(i*degPer)+"deg) translate(110px) rotate(90deg)";
label.textContent=s.name;

wheel.appendChild(label);

});

}
drawWheel();

// ===== SPIN =====
function spin(){

let name = playerName.value;

if(!validName(name)){
alert("Name not allowed");
return;
}

if(!canSpin()){
alert("You can spin once per day");
return;
}

localStorage.setItem("lastSpin",Date.now());

let spinDeg = 1440 + Math.random()*360;
wheel.style.transform="rotate("+spinDeg+"deg)";

setTimeout(()=>{

let pick = weightedPick(species);

result.textContent = name+" the "+pick.name;
portrait.src = pick.img;

unlockCheck(pick.name);

},3800);

}

// ===== UNLOCK CHECK =====
function unlockCheck(trait){

if(!unlocked.includes(trait)){
unlocked.push(trait);
localStorage.setItem("unlocked",JSON.stringify(unlocked));
}

}

// ===== PVE =====
function fightAI(){

let power = unlocked.length * 10 + Math.random()*50;
let enemy = Math.random()*120;

if(power > enemy){
battleLog.textContent = "You won! Power "+Math.floor(power);
}else{
battleLog.textContent = "Enemy won!";
}

}

// ===== ADMIN =====
function showAdmin(){

if(adminPass.value !== ADMIN){
alert("Wrong password");
return;
}

adminArea.innerHTML = `
<input id="newTrait" placeholder="Species Name">
<input id="chance" placeholder="% Chance">
<input id="img" placeholder="Image URL">
<button onclick="addTrait()">Add Trait</button>
`;

}

function addTrait(){

species.push({
name:newTrait.value,
chance:Number(chance.value),
img:img.value
});

drawWheel();
alert("Added!");

}

</script>

</body>
</html>
